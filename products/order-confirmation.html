<!DOCTYPE html>
<html>
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-91362999-4"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'UA-91362999-4');
    </script>
    <link rel="shortcut icon" href="../img/favicon.ico" />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
    <link
      rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/base16/material-palenight.min.css"
    />
    <link rel="stylesheet" href="../css/styles.css" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Automate the creation of banners with dynamic text insertion into a slide and image exporting"
    />
    <title>Thank you | Create web banners automatically | Ben Ronkin</title>
  </head>

  <body>
    <main>
      <nav>
        <div class="nav-wrapper">
          <a href="../index.html" class="brand-logo" style="margin-left: 20px"
            >Ben Ronkin</a
          >
          <a href="#" data-target="mobile" class="sidenav-trigger"
            ><i class="material-icons black-text">menu</i></a
          >
          <ul class="sidenav" id="mobile">
            <li><a href="../products/index.html">Shop scripts</a></li>
            <li><a href="../portfolio/index.html">Case studies</a></li>
            <li><a href="../reviews.html">Client reviews</a></li>
            <li><a href="../blog/index.html">Blog</a></li>
            <li><a href="../contact.html">Contact</a></li>
          </ul>
          <ul id="nav-mobile" class="right hide-on-med-and-down">
            <li data-tooltip="Work">
              <a href="../products/index.html">SHOP</a>
            </li>
            <li data-tooltip="Work">
              <a href="../index.html">CASE STUDIES</a>
            </li>
            <li data-tooltip="Client Testimonials">
              <a href="../reviews.html">REVIEWS</a>
            </li>
            <li data-tooltip="Blog">
              <a href="../blog/index.html"> BLOG</a>
            </li>
            <li data-tooltip="Contact">
              <a href="../contact.html"> CONTACT</a>
            </li>
          </ul>
        </div>
      </nav>

      <div class="container">
        <h1>Finalizing your order...</h1>

        <div class="row">
          <div class="col s12 m6">
            <h2></h2>
            <p></p>
          </div>
        </div>
      </div>
    </main>
    <footer class="page-footer">
      <div class="footer-copyright">
        <div class="container space-between">
          <div>
            <a href="privacy.html">Privacy</a> |
            <a href="terms.html">Terms</a> |
            <a href="../contact.html">Contact</a>
          </div>
          <span>Â© 2020-2023 Copyright Ben Ronkin</span>
          <span
            ><a href="https://benronkin.com/blog/rss.xml">
              <span style="display: flex; align-items: center">
                <i class="material-icons">rss_feed</i> RSS feed
              </span>
            </a></span
          >
        </div>
      </div>
    </footer>
    <script>
      document.addEventListener('DOMContentLoaded', async function () {
        const url =
          'https://script.google.com/macros/s/AKfycbxlokB9w4wwfZz6hqr7-4oTtmxl8w-FgFO6Tc_ObEoQQyte-Y5cf-Ygl_rY3wfKeF8HUg/exec?c=1';
        const headers = new Headers();
        headers.append('Content-Type', 'text/plain;charset=utf-8');
        const req = new Request(url, {
          method: 'POST',
          redirect: 'follow',
          headers,
          body: JSON.stringify({
            session_id: window.location.search.split('=')[1],
          }),
        });
        try {
          const res = await fetch(req);
          const json = await res.json();
          const data = json.resp;
          if (Array.isArray(data)) {
            document.querySelector('h1').innerText = 'Order Confirmation';
            document.querySelector('h2').innerText =
              'Your order was successful';
            document.querySelector('p').innerHTML =
              `<p>Thank you for purchasing ${data[13]}.` +
              ' Please save this receipt for your records.</p>' +
              `<p>Use <a href="${data[14]}" target="_blank">this link</a> to copy the Google Apps Script</p>` +
              `<p>Order ID: ${data[3]}</p>` +
              `<p>Order Date and time: ${data[2]}</p>` +
              `<p>Order Total: ${data[10].toUpperCase()} ${data[11]}</p>` +
              `<p>Product ID: ${data[12]}</p>` +
              `<p>Product Name: ${data[13]}</p>`;
          } else {
            document.querySelector('h1').innerText =
              "We've encountered a problem with your order";
            document.querySelector('h2').innerText = data;
          }
        } catch (error) {
          console.log(error);
        }
      });
    </script>
  </body>
</html>
