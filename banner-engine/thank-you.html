<!DOCTYPE html>
<html>
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-91362999-4"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-91362999-4");
    </script>
    <link rel="shortcut icon" href="../img/favicon.ico" />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
    <link
      rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css"
    />
    <link rel="stylesheet" href="../css/styles.css" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Automate the creation of banners with dynamic text insertion into a slide and image exporting"
    />
    <title>Thank you | Create web banners automatically | Ben Ronkin</title>
  </head>

  <body>
    <main>
      <nav>
        <div class="nav-wrapper">
          <a href="../index.html" class="brand-logo" style="margin-left: 20px"
            >Ben Ronkin</a
          >
          <ul id="nav-mobile" class="right hide-on-med-and-down">
            <li data-tooltip="Work">
              <a href="../index.html"> WORK</a>
            </li>
            <li data-tooltip="Blog">
              <a href="../blog/index.html"> BLOG</a>
            </li>
            <li data-tooltip="Contact">
              <a href="../contact.html"> CONTACT</a>
            </li>
            <li>
              <a href="https://www.linkedin.com/in/ronkin" target="_blank"
                ><img
                  src="../img/li-48.png"
                  alt="LinkedIn"
                  class="responsive-img"
                  width="65%"
              /></a>
            </li>
          </ul>
        </div>
      </nav>

      <div class="container">
        <h1>Finalizing your order...</h1>

        <div class="row">
          <div class="col s12 m6">
            <h2></h2>
            <p></p>
          </div>
        </div>
      </div>
    </main>

    <footer class="page-footer">
      <div class="footer-copyright">
        <div class="container space-between">
          <div>
            <a href="index.html">Banner Engine</a> |
            <a href="privacy.html">Privacy</a> |
            <a href="terms.html">Terms</a> |
            <a href="../contact.html">Contact</a>
          </div>
          <span>Â© 2022 Copyright Ben Ronkin</span>
        </div>
      </div>
    </footer>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const url =
          "https://script.google.com/macros/s/AKfycbwTDsKFeibiPp3wR86ZxObWLJxqQlIkje0BOIFUIsbidiGg_SUo6JnJfDTlJ0WeE8rg4g/exec?d=vp";
        const headers = new Headers();
        headers.append("Content-Type", "text/plain;charset=utf-8");
        const req = new Request(url, {
          method: "POST",
          redirect: "follow",
          headers,
          body: JSON.stringify({
            session_id: window.location.search.split("=")[1],
          }),
        });
        fetch(req)
          .then(response => response.json())
          .then(data => {
            if (data.status == "success") {
              document.querySelector("h1").innerText = "Order Confirmation";
              document.querySelector("h2").innerText =
                "Your order was successful";
              document.querySelector("p").innerHTML =
                "<p>Thank you for purchasing the Banner Engine Add-on license." +
                " Please save this receipt for your records. Your license key is below. Enter the key in the add-on.</p>" +
                `<p>Your license key:</p> <p>${data.license}</p>` +
                `<p>Order Number: ${data.transaction_id}</p>` +
                `<p>Order Date: ${new Date(data.date).toLocaleDateString(
                  "en-US"
                )}</p>` +
                `<p>Order Sub-total: $${data.amount_subtotal}</p>` +
                `<p>Order Total: $${data.amount_total}</p>`;
            } else {
              console.log(data);
            }
          })
          .catch(err => console.log(err));
      });
    </script>
  </body>
</html>
